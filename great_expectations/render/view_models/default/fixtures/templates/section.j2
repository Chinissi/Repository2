{# !!! This content duplicates sections.j2, with one very minor difference:
!!! this one is missing `{% for section in sections %}` and `id="section-{{loop.index}}"`
!!! We'll need to refactor to consolidate. #}

<div style="clear:both; margin-bottom: 50px;">
    
    {% for content_block in section["content_blocks"] %}
        {% if content_block["content_block_type"] == "header" %}
        <h4>{{content_block["content"][0]}}</h4>

        {% elif content_block["content_block_type"] == "text" %}
        <p>
            {{content_block["content"][0]}}
            {# {{ lipsum(1, min=5, max=20) }} #}
        </p>

        {% elif content_block["content_block_type"] == "bullet_list" %}
        <p>
            <ul>
                {% for bullet_point in content_block["content"] %}
                <li>{{ bullet_point }}</li>
                {% endfor %}
            </ul>
        </p>

        {% elif content_block["content_block_type"] == "graph" %}
        <div id="vis-{{section_loop.index}}-{{content_block_loop.index}}" style="width:45%"></div>
        <script>
        // Assign the specification to a local variable vlSpec.
        var vlSpec = {{content_block["content"][0]}};

        // Embed the visualization in the container with id `vis`
        vegaEmbed('#vis-{{section_loop.index}}-{{loop.index}}', vlSpec, {actions: false});
        </script>
        {% elif content_block["content_block_type"] == "table" %}
        <table style="width:50%">
            {% set table = content_block["content"] %}
            {% for row in table %}
            <tr class="{{ loop.cycle('odd', 'even') }}" >
                {% set rowloop = loop %}
                {% for cell in row %}
                    <td id="cell-{{ rowloop.index }}-{{ loop.index }}">{{ cell }}</td>
                {% endfor %}
            </tr>
            {% endfor %}
        </table>

        {% elif content_block["content_block_type"] == "example_list" %}
        {% endif %}
    {% endfor %}
</div>