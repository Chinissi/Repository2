.. _contributing_setting_up_your_dev_environment:



Setting up your dev environment
==========================================

Prerequisites
-------------------

In order to contribute to Great Expectations, you will need the following:

* A GitHub account - this is sufficient if you only want to contribute to the documentation.
* If you want to contribute code, you will also need a working version of Git on your computer. Please refer to the `Git setup instructions <https://git-scm.com/book/en/v2/Getting-Started-Installing-Git>`__ for your environment.
* We also recommend going through the `SSH key setup process on GitHub <https://help.github.com/en/github/authenticating-to-github/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent>`__ for easier authentication.


Fork and clone the repository
------------------------------

**1. Fork the Great Expectations repo**

    * Go to the `Great Expectations repo on GitHub <https://github.com/great-expectations/great_expectations>`__.
    * Click the ``Fork`` button in the top right. This will make a copy of the repo in your own GitHub account.
    * GitHub will take you to your forked version of the repository.


**2.  Clone your fork**

    * Click the green ``Clone`` button and choose the SSH or HTTPS URL depending on your setup. 
    * Copy the URL and run ``git clone <url>`` in your local terminal.
    * This will clone the ``develop`` branch of the great_expectations repo. This is the right place branch from.


**3. Add the upstream remote**

    * On your local machine, cd into the great_expectations repo you cloned in the previous step.
    * Run: ``git remote add upstream git@github.com:great-expectations/great_expectations.git``
    * This sets up a remote called ``upstream`` to track changes to the main branch.

**4. Create a feature branch to start working on your changes.**

    * Ex: ``git checkout -b feature/my-feature-name``
    * Your branch should be named {#FIXME: agree on a convention}. Please see :ref:`contributing_style_guide` for details.


Install python dependencies
------------------------------

**5. Create a new virtual environment**

    * Make a new virtual environment (e.g. using virtualenv or conda), name it "great_expectations_dev" or similar.
    * Ex: ``virtualenv great_expectations_dev; source great_expectations_dev/bin/activate``
    * This is not required, but highly recommended.

**6. Install dependencies from requirements-dev.txt**

    * ``pip install -r requirements-dev.txt``
    *  This will ensure that sure you have the right libraries.


**7. Install great_expectations from your cloned repo**

    * ``pip install -e .``
    * ``-e`` will install in "`editable <https://pip.pypa.io/en/stable/reference/pip_install/#editable-installs>`__" mode. This is not required, but is often very convenient as a developer.

(Optional) Configure resources for testing and documentation
---------------------------------------------------------------

Depending on which features of Great Expectations you want to work on, you may want to configure different backends for local testing, such as postgresql and Spark. Also, there are a couple of extra steps if you want to build documentation locally.

**If you want to develop against local postgresql:**

    * #FIXME

**If you want to develop against local Spark:**

    * #FIXME
    * Probably (?): Make sure you have GCC and Java installed and working on your machine

**If you want to develop against a remote backend:**

    * #FIXME

**If you want to build documentation locally:**

    * ``pip install -r docs/requirements.txt``
    * To build documentation, the command is ``cd docs; make html``
    * Documentation will be generated in ``docs/build/html/`` with the ``index.html`` as the index page.

Run tests to confirm that everything is working
-----------------------------------------

You can run all tests by running ``pytest`` in the great_expectations directory root.

#FIXME: Insert animated gif of normal behavior.

If you did not configure optional backends for testing, tests against these backends will fail.

#FIXME: Insert animated gif of breaking tests.

You can suppress these tests by adding the following flags:

- ``--no-postgresql`` will skip postgres tests
- ``--no-spark`` will skip spark tests 
- ``--no-sqlalchemy`` will skip all tests using sqlalchemy (i.e. all database backends)

For example, you can run ``pytest --no-spark --no-sqlalchemy`` to skip all local backend tests (with the exception of the pandas backend). Please note that these tests will still be run by the CI as soon as you open a PR, so some tests might fail if your code changes affected them.

#FIXME: Insert animated gif with backend tests suppressed.

Note: as of early 2020, the tests generate many warnings. Most of these are generated by dependencies (pandas, sqlalchemy, etc.) You can suppress them with pytest's ``--disable-pytest-warnings`` flag: ``pytest --no-spark --no-sqlalchemy --disable-pytest-warnings``

#FIXME: Insert animated gif with warnings suppressed.


Start coding!
-----------------------------------------

At this point, you have everything you need to start coding!


*last updated*: |lastupdate|