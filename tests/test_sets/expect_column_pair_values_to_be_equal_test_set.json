{
  "dataset" : {
    "w" : [1, 2, 3, 4, 5, 6, 7, 8, 9, null],
    "x" : [1, 2, 3, 4, 5, 6, 7, 8, 9, 10],
    "y" : [1, 2, 3, 4, 5, 6, 7, 8, 9, "abc"],
    "z" : [1, 2, 3, 4, 5, null, null, null, null, null]
  },
  "tests" : [{
    "title" : "Trivial case: x=x",
    "in": {
      "column_A": "x",
      "column_B": "x"
    },
    "out": {
      "exception_list": [],
      "exception_index_list": [],
      "success": true
    }
  },{
    "title" : "Basic negative example",
    "in": {
      "column_A": "x",
      "column_B": "y",
      "output_format": "BASIC"
    },
    "out" : {
      "summary_obj": {
        "exception_percent": 0.1, 
        "partial_exception_list": [
          [10, "abc"]
        ], 
        "exception_percent_nonmissing": 0.1, 
        "exception_count": 1
      }, 
      "success": false      
    }
  }, {
    "title" : "Positive example with mostly",
    "in": {
      "column_A": "x",
      "column_B": "y",
      "mostly": 0.9,
      "output_format": "BASIC"
    },
    "out" : {
      "summary_obj": {
        "exception_percent": 0.1, 
        "partial_exception_list": [
          [10, "abc"]
        ], 
        "exception_percent_nonmissing": 0.1, 
        "exception_count": 1
      }, 
      "success": true
    }
  }, {
    "title" : "Positive example with mismatched null values and keep_missing=both",
    "in": {
      "column_A": "y",
      "column_B": "z",
      "output_format": "BASIC",
      "keep_missing": "both"
    },
    "out" : {
      "summary_obj": {
        "exception_percent": 0.0,
        "partial_exception_list": [], 
        "exception_percent_nonmissing": 0.0,
        "exception_count": 0
      }, 
      "success": true
    }
  }, {
    "title" : "A negative example with mismatched null values and `keep_missing=either` set explicitly",
    "in": {
      "column_A": "w",
      "column_B": "z",
      "output_format": "BASIC",
      "keep_missing": "either"
    },
    "out" : {
      "summary_obj": {
        "exception_percent": 0.4,
        "partial_exception_list": [
          [6.0,null], [7.0,null], [8.0,null], [9.0,null]
        ], 
        "exception_percent_nonmissing": 0.4444444444444444,
        "exception_count": 4
      }, 
      "success": false
    }
  }, {
    "title" : "A negative example with mismatched null values and `keep_missing=either` set by default",
    "in": {
      "column_A": "w",
      "column_B": "z",
      "output_format": "BASIC"
    },
    "out" : {
      "summary_obj": {
        "exception_percent": 0.4,
        "partial_exception_list": [
          [6.0,null], [7.0,null], [8.0,null], [9.0,null]
        ], 
        "exception_percent_nonmissing": 0.4444444444444444,
        "exception_count": 4
      }, 
      "success": false
    }
  }, {
    "title" : "A negative example with output_format=SUMMARY",
    "in": {
      "column_A": "w",
      "column_B": "z",
      "output_format": "SUMMARY"
    },
    "out" : {
      "summary_obj": {
        "element_count": 10,
        "missing_count": 1,
        "missing_percent": 0.1,
        "exception_percent": 0.4,
        "partial_exception_list": [
          [6.0,null], [7.0,null], [8.0,null], [9.0,null]
        ], 
        "partial_exception_counts" : [
          {"value" : [6.0,null], "count" : 1},
          {"value" : [7.0,null], "count" : 1},
          {"value" : [8.0,null], "count" : 1},
          {"value" : [9.0,null], "count" : 1}
        ],
        "partial_exception_index_list": [5,6,7,8],
        "exception_percent_nonmissing": 0.4444444444444444,
        "exception_count": 4
      }, 
      "success": false
    }
  }, {
    "title" : "A positive example with output_format=SUMMARY and mostly",
    "in": {
      "column_A": "w",
      "column_B": "z",
      "mostly": 0.5,
      "output_format": "SUMMARY"
    },
    "out" : {
      "summary_obj": {
        "element_count": 10,
        "missing_count": 1,
        "missing_percent": 0.1,
        "exception_percent": 0.4,
        "partial_exception_list": [
          [6.0,null], [7.0,null], [8.0,null], [9.0,null]
        ], 
        "partial_exception_counts" : [
          {"value" : [6.0,null], "count" : 1},
          {"value" : [7.0,null], "count" : 1},
          {"value" : [8.0,null], "count" : 1},
          {"value" : [9.0,null], "count" : 1}
        ],
        "partial_exception_index_list": [5,6,7,8],
        "exception_percent_nonmissing": 0.4444444444444444,
        "exception_count": 4
      },
      "success": true
    }
  }, {
    "title" : "A positive example with output_format=SUMMARY and keep_missing='both'",
    "in": {
      "column_A": "w",
      "column_B": "z",
      "keep_missing": "both",
      "output_format": "SUMMARY"
    },
    "out" : {
      "summary_obj": {
        "element_count": 10,
        "missing_count": 5,
        "missing_percent": 0.5,
        "exception_percent": 0.0,
        "partial_exception_list": [], 
        "partial_exception_counts" : [],
        "partial_exception_index_list": [],
        "exception_percent_nonmissing": 0.0,
        "exception_count": 0
      }, 
      "success": true
    }
  }]
}